(this.webpackJsonpvlad2=this.webpackJsonpvlad2||[]).push([[0],{19:function(e,t,a){},24:function(e,t,a){e.exports=a(41)},29:function(e,t,a){},31:function(e,t,a){},41:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(10),o=a.n(c),i=(a(29),a(30),a(31),a(7)),s=a(1),l=a(2),u=a(4),m=a(3),d=a(5),p=a(11),f=a(15),h=a.n(f),b=a(21);function y(e){return{name:e.name,temp:parseInt(e.main.temp-273)+"\xb0C",iconLink:"https://openweathermap.org/img/wn/"+e.weather[0].icon+"@2x.png"}}function E(e){return{coord:e.coord.lon+", "+e.coord.lat,wind:e.wind.speed+" m/s",humidity:e.main.humidity+" %",pressure:e.main.pressure+" hpa",clouds:e.weather[0].description}}a(19);var v=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.data.name,t=this.props.data.iconLink,a=this.props.data.temp;return r.a.createElement("div",{className:"col-6"},r.a.createElement("div",{className:"title"},e),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-6"},r.a.createElement("img",{alt:"icon",width:"100px",src:t})),r.a.createElement("div",{className:"col-6 temp"},a)))}}]),t}(n.Component),O=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.data.coord,t=this.props.data.wind,a=this.props.data.humidity,n=this.props.data.pressure,c=this.props.data.clouds;return r.a.createElement("div",null,r.a.createElement("div",{className:"info-row m-1 d-flex"},r.a.createElement("span",null,"\u0412\u0435\u0442\u0435\u0440: "),r.a.createElement("span",{className:"ml-auto"},t)),r.a.createElement("div",{className:"info-row m-1 d-flex"},r.a.createElement("span",null,"\u041e\u0431\u043b\u0430\u0447\u043d\u043e\u0441\u0442\u044c: "),r.a.createElement("span",{className:"ml-auto"},c)),r.a.createElement("div",{className:"info-row m-1 d-flex"},r.a.createElement("span",null,"\u0414\u0430\u0432\u043b\u0435\u043d\u0438\u0435: "),r.a.createElement("span",{className:"ml-auto"},n)),r.a.createElement("div",{className:"info-row m-1 d-flex"},r.a.createElement("span",null,"\u0412\u043b\u0430\u0436\u043d\u043e\u0441\u0442\u044c: "),r.a.createElement("span",{className:"ml-auto"},a)),r.a.createElement("div",{className:"info-row m-1 d-flex"},r.a.createElement("span",null,"\u041a\u043e\u043e\u0440\u0434\u0438\u043d\u0430\u0442\u044b: "),r.a.createElement("span",{className:"ml-auto"},e)))}}]),t}(n.Component),j=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).getWeather=function(){var e=Object(b.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.setState({downloading:!0}),e.next=3,fetch("https://api.openweathermap.org/data/2.5/weather?lat=".concat(t.latitude,"&lon=").concat(t.longitude,"&appid=2e19bb27bd5e717bac388dc0c1827b17")).then((function(e){if(!e.ok)throw Error(e.statusText);return e})).then((function(e){return e.json()})).then((function(e){a.setState({cityHeader:y(e),cityInfo:E(e),error:!1,downloading:!1})})).catch((function(e){a.setState({error:!0,downloading:!1})}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.state={cityHeader:"",cityInfo:"",downloading:!0,error:!1},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return this.state.downloading?r.a.createElement("div",{className:"text-center "},r.a.createElement("div",{className:"title"},"\u041f\u043e\u0434\u043e\u0436\u0434\u0438\u0442\u0435, \u0434\u0430\u043d\u043d\u044b\u0435 \u0437\u0430\u0433\u0440\u0443\u0436\u0430\u044e\u0442\u0441\u044f"),r.a.createElement("div",{className:"spinner-border text-secondary spin"})):this.state.error?r.a.createElement("div",{className:"text-center"},r.a.createElement("span",{className:"title"},"\u0423\u043f\u0441, \u0447\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a")):r.a.createElement("div",{className:"row"},r.a.createElement(v,{data:this.state.cityHeader}),r.a.createElement("div",{className:"col-6"},r.a.createElement(O,{data:this.state.cityInfo})))}},{key:"componentDidUpdate",value:function(e,t,a){this.state===t&&this.getWeather(this.props.position)}}]),t}(n.Component),w="\u041f\u043e\u0433\u043e\u0434\u0430 \u0437\u0434\u0435\u0441\u044c",N="\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0433\u0435\u043e\u043f\u043e\u0437\u0438\u0446\u0438\u044e",g=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).CurrentHeader=r.a.createElement("div",{className:"row "},r.a.createElement("div",{className:"header col-5"},w),r.a.createElement("div",{className:"col-7"},r.a.createElement("button",{className:"btn btn-secondary ",onClick:a.getPosition.bind(Object(p.a)(a))},N))),a.defaultPosition={latitude:55.75,longitude:37.62},a.state={position:a.defaultPosition},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.getPosition()}},{key:"render",value:function(){return r.a.createElement("div",null,this.CurrentHeader,r.a.createElement(j,{position:this.state.position}))}},{key:"getPosition",value:function(){var e=this;navigator.geolocation.getCurrentPosition((function(t){e.setState({position:t.coords})}),(function(t){e.setState({position:e.defaultPosition})}))}}]),t}(n.Component),k=a(23),I=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e,t;return this.props.download||this.props.error||(e=r.a.createElement("span",{className:"p-2 ml-auto mini-temp"},this.props.data.temp),t=r.a.createElement("img",{className:"p-2 ml-auto",alt:"icon",src:this.props.data.iconLink})),r.a.createElement(n.Fragment,null,r.a.createElement("span",{className:"title-sm"},this.props.name),e,t)}}]),t}(n.Component),C=function(e){return{type:"UPDATE_CITY",cityName:e}},x=function(e){return fetch("https://api.openweathermap.org/data/2.5/weather?appid=2e19bb27bd5e717bac388dc0c1827b17&q=".concat(e)).then((function(e){if(!e.ok)throw Error(e.statusText);return e})).then((function(e){return e.json()})).then((function(t){return a=e,n=function(e){return{name:e.name,temp:parseInt(e.main.temp-273)+"\xb0C",iconLink:"https://openweathermap.org/img/wn/"+e.weather[0].icon+".png"}}(t),r=E(t),{type:"UPDATE_CITY_INFO",cityName:a,cityHeader:n,cityInfo:r};var a,n,r})).catch((function(t){return{type:"ERROR_CITY",cityName:e}}))},P=function(e){return{type:"DELETE_CITY",cityName:e}},D=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={error:!1,download:!Boolean(e.cityInfo)},e.cityInfo||e.update(e.name),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.state.error?r.a.createElement("div",{className:"title-sm text-secondary ml-5"},"\u041e\u0439..."):this.state.download?r.a.createElement("div",null,r.a.createElement("span",{className:"spinner-border text-secondary ml-5 m-1 spin"})):r.a.createElement(O,{data:this.props.cityInfo});return r.a.createElement("div",null,r.a.createElement("div",{className:"d-flex flex-row align-items-center"},r.a.createElement(I,{name:this.props.name,data:this.props.cityHeader,download:this.state.download,error:this.state.error}),r.a.createElement("div",{className:"ml-auto"},r.a.createElement("button",{className:"btn btn-circle btn-secondary",onClick:this.props.update.bind(null,this.props.name)},"\u21ba"),r.a.createElement("button",{className:"btn btn-circle btn-secondary",onClick:this.props.delete.bind(null,this.props.name)},"X"))),e)}}],[{key:"getDerivedStateFromProps",value:function(e,t){return{error:Boolean(e.error),download:Boolean(e.download||!Boolean(e.cityInfo))}}}]),t}(n.Component);var T=Object(i.b)(null,(function(e){return{update:function(t){e(C(t)),e(x(t))},delete:function(t){return e(P(t))}}}))(D),S=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"row"},Object.entries(this.props.cities).map((function(e){var t=Object(k.a)(e,2),a=t[0],n=t[1];return r.a.createElement("div",{className:"col-6",key:a},r.a.createElement(T,{name:a,cityInfo:n.cityInfo,cityHeader:n.cityHeader,download:n.download,error:n.error}))})))}}]),t}(n.Component),H=Object(i.b)((function(e){return{cities:e.cities}}),null)(S),_=function(e){return{type:"ADD_CITY",cityName:e}},Y=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={inputValue:""},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("form",{className:"row",onSubmit:function(t){t.preventDefault(),e.props.add(e.state.inputValue)}},r.a.createElement("div",{className:"header col-8"},"\u0418\u0437\u0431\u0440\u0430\u043d\u043d\u043e\u0435"),r.a.createElement("div",{className:"col d-flex"},r.a.createElement("input",{className:"form-control mt-auto",placeholder:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043d\u043e\u0432\u044b\u0439 \u0433\u043e\u0440\u043e\u0434",value:this.state.inputValue,onChange:function(t){e.setState({inputValue:t.target.value})}})),r.a.createElement("div",{className:"d-flex"},r.a.createElement("button",{type:"submit",className:"btn btn-circle btn-secondary mt-auto"},"+")))}}]),t}(n.Component);var L=Object(i.b)(null,(function(e){return{add:function(t){return e(_(t))}}}))(Y),A=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(L,null),r.a.createElement(H,null))}}]),t}(n.Component),B=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"ml-5 mr-5 mt-3 mb-3"},r.a.createElement(g,null),r.a.createElement(A,null))}}]),t}(n.Component),R=a(9),U=a(16);function F(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function J(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?F(a,!0).forEach((function(t){Object(U.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):F(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var V=function(e,t){var a;switch(t.type){case"ADD_CITY":return t.cityName in e?e:J({},e,Object(U.a)({},t.cityName,{cityHeader:null,cityInfo:null,error:!1,download:!0}));case"DELETE_CITY":return delete(a=J({},e))[t.cityName],a;case"UPDATE_CITY":return(a=J({},e))[t.cityName].error=!1,a[t.cityName].download=!0,a;case"UPDATE_CITY_INFO":return(a=J({},e))[t.cityName].cityHeader=t.cityHeader,a[t.cityName].cityInfo=t.cityInfo,a[t.cityName].error=!1,a[t.cityName].download=!1,a;case"ERROR_CITY":return(a=J({},e))[t.cityName].error=!0,a[t.cityName].download=!1,a;default:return e}},W=a(22),q=a.n(W),M=JSON.parse(localStorage.getItem("cityList"))||{cities:{}},X=Object(R.c)((function(e,t){return{cities:V(e.cities,t)}}),M,Object(R.a)(q.a));X.subscribe((function(){localStorage.setItem("cityList",JSON.stringify(X.getState(),(function(e,t){return"error"===e||"download"===e?void 0:t})))}));var $=X;var z=function(){return r.a.createElement(i.a,{store:$},r.a.createElement(B,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(z,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[24,1,2]]]);
//# sourceMappingURL=main.e3f018ec.chunk.js.map